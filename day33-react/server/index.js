// import express from "express";

// 서버 만드는 도구 불러오기
// 프로젝트 생성시 vite로 만들면 설정파일에서 module type이 아니라서
// require()에러가 발생한다.
// 그래서 vite프로젝트는 import를 해야된다.
const express = require("express");
const cors = require("cors");

// 1. 서버 만들기 
const app = express();

// CORS 허용(모든 포트들은 app서버를 사용할 수있다.)
app.use(cors());

// 2. 경로 설정
// 기본 요청 /
app.get("/", (req,res)=>{
    // 응답해줘! 서버 잘 실행됨!글씨를 보내줘!
    res.send("서버 실행 잘됨!");
});

app.get("/client", (req,res)=>{
    res.send("client 서버 동작했다!.");
});

// 네이버에서 JSON타입으로 데이터를 보낼때 
app.get("/json", (req,res)=>{
    res.json({
        message : "JSON응답!",
        count : 1 
    });
});

// 현재 시간을 보내는 응답
// 변하는 데이터를 서버가 만들어준다느 느낌!(동적 데이터)
app.get("/time", (req,res)=>{
    res.send("현재 시간: " + new Date().toLocaleString());
});

// 네이버에서 query=강동원 
// 요청을 할 때 변수값들을 꺼내서 처리를 한다.
// 요청url.물음표뒤에 단어가져와 (query).변수명
app.get("/search", (req,res) =>{
    const num = req.query.num;
    console.log("서버에서 request: ", num);
    
    // 응답을 안해주면 요청한 브라우저는 계속 기다리고 있다.
    // 그래서 axios 도구가 시간을 설정해서 끊어버린다.!
    res.send("데이터 잘 왔다!");
});



// 3. 위에 경로로 통신할 때 
//   서버를 포트 번호를 설정
app.listen(4000, () => {
    console.log("서버가 실행됩니다! http://localhost:4000");
});

// 4. 위에 코드로 서버를 만들었다.
// 5. 이제 서버를 먼저 시작하기!

// **서버는 새로운 내용이 추가가되면 무조건 서버를 다시 실행해야된다.**
// *** 실행의 순서는 무조건 서버부터 실행 후 내 프론트 화면을 
//     실행해야된다  ***




// ------------------------------------------------------
/*
┌──────────────────────────────────────────┐
│         1) 서버 도구(express) 불러오기   │
└──────────────────────────────────────────┘
                     │
                     ▼
┌──────────────────────────────────────────┐
│        2) app = express()로 서버 만들기  │
└──────────────────────────────────────────┘
                     │
                     ▼
┌──────────────────────────────────────────┐
│  3) app.get("/") : "/" 경로 요청 처리 준비│
│       → 누가 "/" 주소로 요청하면            │
│       "서버 실행 잘됨!"  응답 보내기       │
└──────────────────────────────────────────┘
                     │
                     ▼
┌──────────────────────────────────────────┐
│ 4) app.listen(4000)                      │
│    → 4000번 포트에서 서버 '대기 시작'     │
│    → "서버가 실행됩니다!" 콘솔 출력        │
└──────────────────────────────────────────┘
                     │
                     ▼
┌──────────────────────────────────────────┐
│ 5) 브라우저에서                           │
│    http://localhost:4000                 │
│    접속하면 서버가 요청을 받아           │
│    "/" 처리 로직(app.get) 실행           │
└──────────────────────────────────────────┘
                     │
                     ▼
┌──────────────────────────────────────────┐
│ 6) 서버가 응답 반환                         │
│    "서버 실행 잘됨!"                        │
└──────────────────────────────────────────┘


*/